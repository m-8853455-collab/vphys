<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>VPhys â€“ The Virtual Physics Lab</title>

<style>
body {
  font-family: Arial, sans-serif;
  margin: 0;
  background: #eef2f7;
}

header {
  background: #1e3a8a;
  color: white;
  padding: 20px;
  text-align: center;
}

/* ðŸ”‘ FIX: flex-wrap added */
.container {
  display: flex;
  flex-wrap: wrap;
  gap: 20px;
  margin: 20px;
}

section {
  background: white;
  padding: 20px;
  border-radius: 8px;
}

.controls {
  width: 340px;
}

canvas {
  border: 1px solid black;
  background: #e6f7fb;
  touch-action: none;
}

button {
  padding: 8px 14px;
  background: #1e3a8a;
  color: white;
  border: none;
  border-radius: 5px;
  margin-top: 6px;
  cursor: pointer;
}

footer {
  background: #1e3a8a;
  color: white;
  text-align: center;
  padding: 10px;
}

.formula-table {
  width: 100%;
  border-collapse: collapse;
  margin-top: 10px;
}

.formula-table th,
.formula-table td {
  border: 1px solid #333;
  padding: 6px;
  text-align: center;
}

.formula-table th {
  background: #1e3a8a;
  color: white;
}

.formula-table td {
  font-family: Courier New, monospace;
}
</style>
</head>

<body>

<header>
<h1>VPhys</h1>
<p>The Virtual Physics Lab</p>
</header>

<div class="container">

<!-- ===== CANVAS & FORMULAS ===== -->
<section>
<canvas id="sim" width="600" height="350"></canvas>

<h3>Projectile Motion Formula Reference</h3>
<table class="formula-table">
<tr><th>x-axis</th><th>y-axis</th></tr>
<tr><td>aâ‚“ = 0</td><td>aáµ§ = âˆ’g</td></tr>
<tr><td>Vâ‚“ = uâ‚“</td><td>Váµ§ = uáµ§ âˆ’ gt</td></tr>
<tr><td>Sâ‚“ = uâ‚“t</td><td>Sáµ§ = uáµ§t âˆ’ Â½gtÂ²</td></tr>
<tr><td>Sâ‚“ = Â½(uâ‚“+Vâ‚“)t</td><td>Sáµ§ = Â½(uáµ§+Váµ§)t</td></tr>
</table>
</section>

<!-- ===== CONTROLS ===== -->
<section class="controls">
<h3>Projectile Inputs</h3>

<p>Initial speed u (m/s)</p>
<input id="u" type="number" value="20">

<p>Launch angle Î¸ (Â°)</p>
<input id="theta" type="number" value="45">

<p>Platform height h (m)</p>
<input id="platformH" type="number" value="5">

<p>Environment</p>
<select id="env">
  <option value="9.8">Earth</option>
  <option value="1.62">Moon</option>
</select>

<button onclick="launch()">â–¶ Start</button>
<button onclick="zoomIn()">âž• Zoom In</button>
<button onclick="zoomOut()">âž– Zoom Out</button>

<hr>

<h3>Results</h3>
<p>t = <span id="time">â€“</span> s</p>
<p>Sx = <span id="sx">â€“</span> m</p>
<p>Sy = <span id="sy">â€“</span> m</p>
<p>Vx = <span id="vx">â€“</span> m/s</p>
<p>Vy = <span id="vy">â€“</span> m/s</p>
<p>v = <span id="vr">â€“</span> m/s</p>
</section>

</div>

<footer>
Â© 2026 VPhys â€“ The Virtual Physics Lab
</footer>

<script>
const canvas = document.getElementById("sim");
const ctx = canvas.getContext("2d");

const groundY = canvas.height - 20;
let scale = 5;

let path = [];
let dragIndex = 0;
let dragging = false;
let animIndex = 0;
let animating = false;

/* ===== ZOOM (SAFE) ===== */
function zoomIn(){
  scale = Math.min(scale * 1.2, 20);
  draw();
}

function zoomOut(){
  scale = Math.max(scale / 1.2, 1);
  draw();
}

/* ===== START ===== */
function launch() {
  scale = 5;   // reset zoom to keep projectile visible

  const u = +u.value;
  const theta = +theta.value * Math.PI/180;
  const g = +env.value;
  const h = +platformH.value;

  const ux = u * Math.cos(theta);
  const uy = u * Math.sin(theta);

  path = [{x:0, y:h, ux, uy, t:0}];

  for(let t=0.05; t<30; t+=0.05){
    const x = ux*t;
    const y = h + uy*t - 0.5*g*t*t;
    if(y < 0) break;
    path.push({x,y,ux,uy,t});
  }

  dragIndex = 0;
  animIndex = 0;
  animating = true;
  dragging = false;
  animate();
}

/* ===== ANIMATION ===== */
function animate(){
  if(!animating) return;
  dragIndex = animIndex;
  draw();
  animIndex++;
  if(animIndex >= path.length){
    animating = false;
    dragging = true;
    return;
  }
  requestAnimationFrame(animate);
}

/* ===== DRAW ===== */
function draw(){
  ctx.clearRect(0,0,canvas.width,canvas.height);

  ctx.fillStyle = "blue";
  ctx.fillRect(0, groundY, canvas.width, 5);

  if(path.length){
    const platformY = groundY - path[0].y * scale;
    ctx.fillRect(0, platformY, 80, 5);
  }

  ctx.fillStyle = "black";
  path.forEach(p=>{
    ctx.beginPath();
    ctx.arc(p.x*scale, groundY - p.y*scale, 2, 0, Math.PI*2);
    ctx.fill();
  });

  if(!path.length) return;
  const p = path[dragIndex];

  ctx.fillStyle = "red";
  ctx.beginPath();
  ctx.arc(p.x*scale, groundY - p.y*scale, 6, 0, Math.PI*2);
  ctx.fill();

  const vy = p.uy - (+env.value)*p.t;

  time.textContent = p.t.toFixed(2);
  sx.textContent = p.x.toFixed(2);
  sy.textContent = p.y.toFixed(2);
  vx.textContent = p.ux.toFixed(2);
  document.getElementById("vy").textContent = vy.toFixed(2);
  vr.textContent = Math.sqrt(p.ux*p.ux + vy*vy).toFixed(2);
}

/* ===== DRAG ===== */
canvas.addEventListener("pointerdown", ()=>{ if(!animating) dragging=true; });
canvas.addEventListener("pointerup", ()=> dragging=false);
canvas.addEventListener("pointermove", e=>{
  if(!dragging) return;
  const x = (e.clientX - canvas.getBoundingClientRect().left)/scale;
  let closest = 0;
  path.forEach((p,i)=>{
    if(Math.abs(p.x-x) < Math.abs(path[closest].x-x)) closest=i;
  });
  dragIndex = closest;
  draw();
});
</script>

</body>
</html>
