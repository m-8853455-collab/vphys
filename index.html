<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>VPhys – The Virtual Physics Lab</title>

<style>
body { font-family: Arial, sans-serif; margin:0; background:#eef2f7; }
header { background:#1e3a8a; color:white; padding:20px; text-align:center; }
.container { display:flex; gap:20px; margin:20px; }
section { background:white; padding:20px; border-radius:8px; }
.controls { width:340px; }
canvas { border:1px solid black; background:#e6f7fb; touch-action:none; }
button {
  padding:8px 14px; background:#1e3a8a; color:white;
  border:none; border-radius:5px; margin-top:6px; cursor:pointer;
}
footer { background:#1e3a8a; color:white; text-align:center; padding:10px; }

.formula-table {
  width:100%; border-collapse:collapse; margin-top:10px;
}
.formula-table th,.formula-table td {
  border:1px solid #333; padding:6px; text-align:center;
}
.formula-table th { background:#1e3a8a; color:white; }
.formula-table td { font-family:Courier New, monospace; }
</style>
</head>

<body>

<header>
<h1>VPhys</h1>
<p>The Virtual Physics Lab</p>
</header>

<div class="container">

<section>
<canvas id="sim" width="600" height="350"></canvas>

<h3>Projectile Motion Formula Reference</h3>
<table class="formula-table">
<tr><th>x-axis</th><th>y-axis</th></tr>
<tr><td>aₓ = 0</td><td>aᵧ = −g</td></tr>
<tr><td>Vₓ = uₓ</td><td>Vᵧ = uᵧ − gt</td></tr>
<tr><td>Sₓ = uₓt</td><td>Sᵧ = uᵧt − ½gt²</td></tr>
<tr><td>Sₓ = ½(uₓ+Vₓ)t</td><td>Sᵧ = ½(uᵧ+Vᵧ)t</td></tr>
</table>
</section>

<section class="controls">
<h3>Projectile Inputs</h3>

<p>Initial speed u (m/s)</p>
<input id="u" type="number" value="20">

<p>Launch angle θ (°)</p>
<input id="theta" type="number" value="45">

<p>Platform height h (m)</p>
<input id="platformH" type="number" value="5">

<p>Environment</p>
<select id="env">
  <option value="9.8">Earth</option>
  <option value="1.62">Moon</option>
</select>

<button onclick="launch()">▶ Start</button>
<button onclick="zoomIn()">➕ Zoom In</button>
<button onclick="zoomOut()">➖ Zoom Out</button>

<hr>

<h3>Results</h3>
<p>t = <span id="time">–</span> s</p>
<p>Sx = <span id="sx">–</span> m</p>
<p>Sy = <span id="sy">–</span> m</p>
<p>Vx = <span id="vx">–</span> m/s</p>
<p>Vy = <span id="vy">–</span> m/s</p>
<p>v = <span id="vr">–</span> m/s</p>
</section>

</div>

<!-- ================= WORK–ENERGY THEOREM (IMPROVED) ================= -->
<section>
<h2>Work–Energy Theorem Simulation (Spring–Block)</h2>

<p style="font-family:Courier New;">
W = ΔKE = ½mv² − ½mu²
</p>

<div style="display:flex; gap:20px; flex-wrap:wrap;">

<!-- ===== DISPLAY PANEL ===== -->
<div style="min-width:220px;">
<h3>Real-time Values</h3>
<p>Force, F = <span id="weF">0</span> N</p>
<p>Displacement, x = <span id="weX">0</span> m</p>
<p>Work done, W = <span id="weW">0</span> J</p>
<p>Kinetic Energy, KE = <span id="weKE">0</span> J</p>
<p>Velocity, v = <span id="weV">0</span> m/s</p>
</div>

<!-- ===== CONTROLS ===== -->
<div style="min-width:220px;">
<h3>Parameters</h3>

<p>Mass (kg)</p>
<input id="weMass" type="number" value="1">

<p>Spring constant k (N/m)</p>
<input id="weK" type="number" value="50">

<p>Initial stretch x₀ (m)</p>
<input id="weX0" type="number" value="0.2">

<button onclick="startWE()">▶ Start</button>
</div>

</div>

<canvas id="weCanvas" width="500" height="200"
        style="border:1px solid black; background:#f9fbff; margin-top:15px;">
</canvas>

<p style="font-size:13px;color:#555;">
Drag-and-release spring–block system demonstrating the Work–Energy Theorem.
</p>
</section>

<script>
const weCanvas = document.getElementById("weCanvas");
const wectx = weCanvas.getContext("2d");

let weRunning = false;
let x, v, m, k;
let x0;
const dt = 0.02;
const scaleWE = 200; // visual scale

function startWE(){
  m = +weMass.value;
  k = +weK.value;
  x0 = +weX0.value;

  x = x0;
  v = 0;
  weRunning = true;
  requestAnimationFrame(updateWE);
}

function updateWE(){
  if(!weRunning) return;

  // Spring force
  const F = -k * x;
  const a = F / m;

  // Update motion (simple Euler)
  v += a * dt;
  x += v * dt;

  // Energies
  const KE = 0.5 * m * v * v;
  const W = KE; // ΔKE (u = 0)

  // Display values
  weF.textContent = F.toFixed(2);
  weX.textContent = x.toFixed(3);
  weV.textContent = v.toFixed(2);
  weKE.textContent = KE.toFixed(2);
  weW.textContent = W.toFixed(2);

  drawWE(F, KE);
  requestAnimationFrame(updateWE);
}

function drawWE(F, KE){
  wectx.clearRect(0,0,weCanvas.width,weCanvas.height);

  const baseY = 120;
  const blockX = 150 + x * scaleWE;

  // Wall
  wectx.fillStyle = "#333";
  wectx.fillRect(20,80,10,80);

  // Spring
  wectx.strokeStyle = "#666";
  wectx.beginPath();
  wectx.moveTo(30,120);
  wectx.lineTo(blockX,120);
  wectx.stroke();

  // Block
  wectx.fillStyle = "#555";
  wectx.fillRect(blockX,100,40,40);

  // Force vector
  wectx.strokeStyle = "red";
  wectx.beginPath();
  wectx.moveTo(blockX+20,95);
  wectx.lineTo(blockX+20 + F*2,95);
  wectx.stroke();

  // Velocity vector
  wectx.strokeStyle = "blue";
  wectx.beginPath();
  wectx.moveTo(blockX+20,150);
  wectx.lineTo(blockX+20 + v*30,150);
  wectx.stroke();

  // KE bar
  wectx.fillStyle = "green";
  wectx.fillRect(350,150-KE*5,30,KE*5);
  wectx.fillText("KE",345,160);
}
</script>
