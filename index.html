<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>VPhys – The Virtual Physics Lab</title>

<style>
body { font-family: Arial, sans-serif; margin:0; background:#eef2f7; }
header { background:#1e3a8a; color:white; padding:20px; text-align:center; }
.container { display:flex; gap:20px; margin:20px; }
section { background:white; padding:20px; border-radius:8px; }
.controls { width:340px; }
canvas { border:1px solid black; background:#e6f7fb; touch-action:none; }
button {
  padding:8px 14px; background:#1e3a8a; color:white;
  border:none; border-radius:5px; margin-top:6px; cursor:pointer;
}
footer { background:#1e3a8a; color:white; text-align:center; padding:10px; }

.formula-table {
  width:100%; border-collapse:collapse; margin-top:10px;
}
.formula-table th,.formula-table td {
  border:1px solid #333; padding:6px; text-align:center;
}
.formula-table th { background:#1e3a8a; color:white; }
.formula-table td { font-family:Courier New, monospace; }
</style>
</head>

<body>

<header>
<h1>VPhys</h1>
<p>The Virtual Physics Lab</p>
</header>

<!-- ================= PROJECTILE MOTION (UNCHANGED) ================= -->
<div class="container">

<section>
<canvas id="sim" width="600" height="350"></canvas>

<h3>Projectile Motion Formula Reference</h3>
<table class="formula-table">
<tr><th>x-axis</th><th>y-axis</th></tr>
<tr><td>aₓ = 0</td><td>aᵧ = −g</td></tr>
<tr><td>Vₓ = uₓ</td><td>Vᵧ = uᵧ − gt</td></tr>
<tr><td>Sₓ = uₓt</td><td>Sᵧ = uᵧt − ½gt²</td></tr>
<tr><td>Sₓ = ½(uₓ+Vₓ)t</td><td>Sᵧ = ½(uᵧ+Vᵧ)t</td></tr>
</table>
</section>

<section class="controls">
<h3>Projectile Inputs</h3>

<p>Initial speed u (m/s)</p>
<input id="u" type="number" value="20">

<p>Launch angle θ (°)</p>
<input id="theta" type="number" value="45">

<p>Platform height h (m)</p>
<input id="platformH" type="number" value="5">

<p>Environment</p>
<select id="env">
  <option value="9.8">Earth</option>
  <option value="1.62">Moon</option>
</select>

<button onclick="launch()">▶ Start</button>
<button onclick="zoomIn()">➕ Zoom In</button>
<button onclick="zoomOut()">➖ Zoom Out</button>

<hr>

<h3>Results</h3>
<p>t = <span id="time">–</span> s</p>
<p>Sx = <span id="sx">–</span> m</p>
<p>Sy = <span id="sy">–</span> m</p>
<p>Vx = <span id="vx">–</span> m/s</p>
<p>Vy = <span id="vy">–</span> m/s</p>
<p>v = <span id="vr">–</span> m/s</p>
</section>

</div>

<!-- ================= WORK–ENERGY THEOREM (IMPROVED ONLY) ================= -->
<section>
<h2>Work–Energy Theorem Simulation (Spring–Block System)</h2>

<p style="font-family:Courier New;">
W = ΔKE = ½mv² − ½mu²
</p>

<div style="display:flex; gap:20px; flex-wrap:wrap;">

<div>
<h3>Real-time Display</h3>
<p>Force F = <span id="weF">0</span> N</p>
<p>Displacement x = <span id="weX">0</span> m</p>
<p>Velocity v = <span id="weV">0</span> m/s</p>
<p>Kinetic Energy KE = <span id="weKE">0</span> J</p>
<p>Work Done W = <span id="weW">0</span> J</p>
</div>

<div>
<h3>Parameters</h3>
<p>Mass (kg)</p>
<input id="weMass" value="1">

<p>Spring constant k (N/m)</p>
<input id="weK" value="40">

<p>Initial stretch x₀ (m)</p>
<input id="weX0" value="0.25">

<button onclick="startWE()">▶ Start</button>
</div>

</div>

<canvas id="weCanvas" width="520" height="220"
style="border:1px solid black; background:#f9fbff; margin-top:15px;">
</canvas>

<p style="font-size:13px;color:#555;">
Spring–block system demonstrating the Work–Energy Theorem with real-time force,
velocity vectors, kinetic energy bar, and displacement trail.
</p>
</section>

<footer>© 2026 VPhys – The Virtual Physics Lab</footer>

<!-- ================= PROJECTILE MOTION JS (UNCHANGED) ================= -->
<script>
const canvas = document.getElementById("sim");
const ctx = canvas.getContext("2d");

const groundY = canvas.height - 20;
let scale = 5;

let path = [];
let dragIndex = 0;
let dragging = false;
let animIndex = 0;
let animating = false;

function zoomIn(){ scale *= 1.2; draw(); }
function zoomOut(){ scale /= 1.2; draw(); }

function launch() {
  const u = +u.value;
  const theta = +theta.value * Math.PI/180;
  const g = +env.value;
  const h = +platformH.value;

  const ux = u * Math.cos(theta);
  const uy = u * Math.sin(theta);

  path = [{x:0, y:h, ux, uy, t:0}];
  for(let t=0.05;t<30;t+=0.05){
    const x = ux*t;
    const y = h + uy*t - 0.5*g*t*t;
    if(y < 0) break;
    path.push({x,y,ux,uy,t});
  }

  dragIndex = 0;
  animIndex = 0;
  animating = true;
  dragging = false;
  animate();
}

function animate(){
  if(!animating) return;
  dragIndex = animIndex;
  draw();
  animIndex++;
  if(animIndex >= path.length){
    animating = false;
    dragging = true;
    return;
  }
  requestAnimationFrame(animate);
}

function draw(){
  ctx.clearRect(0,0,canvas.width,canvas.height);

  ctx.fillStyle = "blue";
  ctx.fillRect(0, groundY, canvas.width, 5);

  if(path.length){
    const platformY = groundY - path[0].y * scale;
    ctx.fillRect(0, platformY, 80, 5);
  }

  ctx.fillStyle = "black";
  path.forEach(p=>{
    ctx.beginPath();
    ctx.arc(p.x*scale, groundY - p.y*scale, 2, 0, Math.PI*2);
    ctx.fill();
  });

  if(!path.length) return;
  const p = path[dragIndex];

  ctx.fillStyle = "red";
  ctx.beginPath();
  ctx.arc(p.x*scale, groundY - p.y*scale, 6, 0, Math.PI*2);
  ctx.fill();

  const vy = p.uy - (+env.value)*p.t;
  time.textContent = p.t.toFixed(2);
  sx.textContent = p.x.toFixed(2);
  sy.textContent = p.y.toFixed(2);
  vx.textContent = p.ux.toFixed(2);
  vySpan = vy.toFixed(2); document.getElementById("vy").textContent = vySpan;
  vr.textContent = Math.sqrt(p.ux*p.ux + vy*vy).toFixed(2);
}

canvas.addEventListener("pointerdown",()=>{ if(!animating) dragging=true; });
canvas.addEventListener("pointerup",()=>dragging=false);
canvas.addEventListener("pointermove",e=>{
  if(!dragging) return;
  const x=(e.clientX-canvas.getBoundingClientRect().left)/scale;
  let c=0;
  path.forEach((p,i)=>{
    if(Math.abs(p.x-x)<Math.abs(path[c].x-x)) c=i;
  });
  dragIndex=c; draw();
});
</script>

<!-- ================= WORK–ENERGY JS (NEW, ISOLATED) ================= -->
<script>
const weCanvas = document.getElementById("weCanvas");
const wectx = weCanvas.getContext("2d");

let x=0, v=0, m=1, k=40;
let trail=[]; const dt=0.02, scaleWE=200;

function startWE(){
  m=+weMass.value;
  k=+weK.value;
  x=+weX0.value;
  v=0;
  trail=[];
  requestAnimationFrame(updateWE);
}

function updateWE(){
  const F = -k * x;
  const a = F / m;

  v += a * dt;
  x += v * dt;

  const KE = 0.5 * m * v * v;
  const W = KE;

  weF.textContent = F.toFixed(2);
  weX.textContent = x.toFixed(3);
  weV.textContent = v.toFixed(2);
  weKE.textContent = KE.toFixed(2);
  weW.textContent = W.toFixed(2);

  trail.push(x);
  if(trail.length > 60) trail.shift();

  drawWE(F, KE);
  requestAnimationFrame(updateWE);
}

function drawWE(F, KE){
  wectx.clearRect(0,0,weCanvas.width,weCanvas.height);

  const baseY=130;
  const blockX=160 + x*scaleWE;

  // wall
  wectx.fillStyle="#333";
  wectx.fillRect(30,70,10,120);

  // trail
  wectx.strokeStyle="#ccc";
  wectx.beginPath();
  trail.forEach((tx,i)=>{
    const px=160+tx*scaleWE;
    if(i===0) wectx.moveTo(px,baseY);
    else wectx.lineTo(px,baseY);
  });
  wectx.stroke();

  // spring
  wectx.strokeStyle="#666";
  wectx.beginPath();
  wectx.moveTo(40,baseY);
  wectx.lineTo(blockX,baseY);
  wectx.stroke();

  // block
  wectx.fillStyle="#555";
  wectx.fillRect(blockX,baseY-20,40,40);

  // force vector
  wectx.strokeStyle="red";
  wectx.beginPath();
  wectx.moveTo(blockX+20,baseY-30);
  wectx.lineTo(blockX+20+F*1.5,baseY-30);
  wectx.stroke();

  // velocity vector
  wectx.strokeStyle="blue";
  wectx.beginPath();
  wectx.moveTo(blockX+20,baseY+40);
  wectx.lineTo(blockX+20+v*30,baseY+40);
  wectx.stroke();

  // KE bar
  wectx.fillStyle="green";
  wectx.fillRect(430,180-KE*6,25,KE*6);
  wectx.fillText("KE",428,195);
}
</script>

</body>
</html>
